{"body": [{"indent": 0, "text": ["VDB from Particle Fluid"], "type": "title", "extent": [0, 28], "level": 0}, {"indent": 0, "type": "summary", "extent": [138, 277], "text": ["Generates a signed distance field (SDF) VDB volume representing the surface of a set of particles from a particle fluid simulation."]}, {"indent": 0, "type": "para", "extent": [277, 555], "text": ["This node replaces the ", {"text": ["Particle Fluid Surface node"], "fullpath": "/nodes/sop/particlefluidsurface", "scheme": "Node", "type": "link", "value": "/nodes/sop/particlefluidsurface"}, ". This node is much faster, uses less memory, gives smoother (less lumpy) results, and has much better \"sheeting\" (narrow tendrils will appear as connected fluid, instead of a line of droplets)."]}, {"indent": 0, "type": "para", "extent": [555, 855], "text": ["This node outputs a Signed Distance Field (SDF) VDB the zero-level set of which represents the fluid surface.\nThe output VDB can then be converted into a Polygon or PolySoup surface using the ", {"text": ["Convert VDB node"], "fullpath": "/nodes/sop/convertvdb", "scheme": "Node", "type": "link", "value": "/nodes/sop/convertvdb"}, ".\nNo points or primitives from the input will appear in the output. "]}, {"body": [{"body": [{"body": [{"indent": 4, "type": "para", "extent": [922, 1170], "text": ["When the checkbox is on, the node will only refine the geometry the specified number of times. When off, the node uses as many iterations as it needs to achieve a certain quality. Set this parameter from 1 to 4 to trade speed for quality."]}, {"indent": 4, "type": "para", "extent": [1170, 1393], "text": ["The number of iterations chosen by the node is always finite,\n    and the time taken by each iteration drops quickly as the number increases.\n    So, there is little benefit to setting an explicit limit beyond 3 or 4."]}], "indent": 0, "text": ["Limit Refinement Iterations"], "role": "item", "attrs": {"id": "limitrefinement"}, "extent": [867, 897], "type": "parameters_item"}, {"body": [{"body": [{"indent": 8, "type": "para", "extent": [1581, 1673], "text": ["Voxels outside this band carry the background value of the VDB (or its negation). "]}], "indent": 4, "type": "para", "extent": [1411, 1581], "text": ["The width (in voxels) of the band around the generated surface on each side of the surface inside which the generated VDB stores detailed values of the output field."]}], "indent": 0, "text": ["Half-Band Voxels"], "role": "item", "extent": [1393, 1411], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [1686, 2414], "text": ["Converts the output to a standard signed distance field (SDF).\n    If this option is off, the output will be a scalar field for which the zero level set represents the \n    fluid surface and the signs assigned to voxels agree with those of a standard SDFs \n    (negative inside the fluid and positive outside of it). However, it is not a proper distance field \n    in that its non-zero levels do not necessarily represent regular offsets of its 0 level. For example, the 0.1 level surface may not uniformly lie at distance of 0.1 from the 0.0 level surface. Furthermore, the background values of the VDB on the two sides of the surface are -1 and +1. Having this option off may generate a slightly higher quality surface. "]}], "indent": 0, "text": ["Rebuild SDF"], "role": "item", "extent": [1673, 1686], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [2427, 2480], "text": ["The name for the generated field in the output."]}], "indent": 0, "text": ["Output Name"], "role": "item", "extent": [2414, 2427], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}, {"body": [{"indent": 0, "type": "para", "extent": [2508, 2634], "text": ["Parameters on this tab control the output resolution, the sizing of the particles, and the extent of particle interaction. "]}, {"body": [{"body": [{"indent": 4, "type": "para", "extent": [2650, 2896], "text": ["Resample the particles using the parameters below in order to compensate for irregularities in distribution of particles.\n    This can reduce the number of particles in over-sampled areas, giving better performance and preventing artifacts."]}], "indent": 0, "text": ["Resample Input"], "role": "item", "extent": [2634, 2650], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [2936, 3060], "text": ["The particle separation used in the simulation. This is used as a unit length for the following next three parameters."]}], "indent": 0, "text": ["Particle Separation"], "role": "item", "attrs": {"id": "psep"}, "extent": [2896, 2917], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [3094, 3377], "text": ["The voxel side length to use for the generated VDB volume.\n    This is a scale on the ", {"text": ["Particle separation"], "type": "ui"}, " length.\n    For example, if ", {"text": ["Particle separation"], "type": "ui"}, " is ", {"text": ["0.1"], "type": "code"}, " and ", {"text": ["Voxel size"], "type": "ui"}, " is ", {"text": ["0.5"], "type": "code"}, ",\n    the side length of the voxels of the output field will be ", {"text": ["0.05"], "type": "code"}, "."]}], "indent": 0, "text": ["Voxel Scale"], "role": "item", "attrs": {"id": "voxelscale"}, "extent": [3060, 3073], "type": "parameters_item"}, {"body": [{"body": [{"indent": 8, "type": "para", "extent": [3795, 4220], "text": ["Generally, higher values give more connected (and smoother) output which resembles fluids at smaller scales.\n        However, increasing this increases the cooking time ", {"text": ["cubically"], "type": "em"}, " with respect to the radius over the voxel size, particularly if ", {"text": ["Resample Input"], "type": "ui"}, " options is not selected. Resampling substantially compensates for the cubic growth in performance, though much less so for the growth in memory usage. "]}], "indent": 4, "type": "para", "extent": [3419, 3795], "text": ["The maximum distance at which particles interact.\n    Small increases can give smoother results but increase the cooking time and memory usage greatly.\n    This is a scale on the ", {"text": ["Particle separation"], "type": "ui"}, " length.\n    For example, if ", {"text": ["Particle separation"], "type": "ui"}, " is ", {"text": ["0.1"], "type": "code"}, " and ", {"text": ["Influence radius"], "type": "ui"}, " is ", {"text": ["3"], "type": "code"}, ",\n    particles will interact if they are within ", {"text": ["0.6"], "type": "code"}, " units of each other."]}], "indent": 0, "text": ["Influence Scale"], "role": "item", "attrs": {"id": "influencescale"}, "extent": [3377, 3394], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [4258, 4587], "text": ["The approximate desired distance between the particles and the generated surface. \n    This is a scale on the ", {"text": ["Particle separation"], "type": "ui"}, " length, and must be smaller than the ", {"text": ["Influence scale"], "type": "ui"}, ".\n    It becomes a scale on the ", {"text": ["pscale"], "type": "code"}, " attribute value (instead of ", {"text": ["Particle separation"], "type": "ui"}, " length) \n    if ", {"text": ["pscale"], "type": "code"}, " is present."]}, {"body": [{"body": [{"indent": 8, "type": "para", "extent": [4597, 4894], "text": ["This accurately determines the radius of a droplet formed by an isolated particle since in absence of interactions from other particles, the desired distance between a particle and the generated surface is realized exactly in the form of a sphere (droplet) centered at the particle. "]}], "indent": 4, "role": "item", "type": "note", "extent": [4587, 4597]}], "container": true, "role": "item_group", "type": "note_group"}, {"indent": 4, "type": "para", "extent": [4894, 5238], "text": ["You can use the ", {"text": ["pscale"], "type": "code"}, " attribute to locally manipulate the distance of the surface to particles\n    (pulling it closer or pushing it away).\n    The ", {"text": ["pscale"], "type": "code"}, " value replaces ", {"text": ["Particle Separation"], "type": "ui"}, " as the scale by which this parameter is multiplied \n    to calculate the indented distance of each particle from the surface of the fluid.  "]}, {"indent": 4, "type": "para", "extent": [5238, 5392], "text": ["You must ensure the ", {"text": ["Droplet Scale"], "type": "ui"}, " times ", {"text": ["pscale"], "type": "code"}, " value of all particles is smaller than\n    ", {"text": ["Influence Radius"], "type": "ui"}, " times ", {"text": ["Particle Separation"], "type": "ui"}, ". "]}], "indent": 0, "text": ["Droplet Scale"], "role": "item", "attrs": {"id": "dropletscale"}, "extent": [4220, 4235], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}], "indent": 0, "level": 2, "text": ["Particles"], "extent": [2480, 2508], "container": true, "type": "h", "id": "particles"}, {"body": [{"indent": 0, "type": "para", "extent": [5405, 5521], "text": ["The Advanced tab provides control over tiling and memory management aspects of of the fluid surfacing algorithm. "]}, {"body": [{"body": [{"indent": 4, "type": "para", "extent": [5532, 6036], "text": ["The size of the cubic \"tiles\" used by the algorithm. These tiles are visualized in the viewport when the     display flag on this node is on. Tiles can be processed in parallel, so if you have many CPUs you may     want smaller tiles. There is however an overhead in distributing the work into tiles which increases with having more tiles. The amount of memory used by the node is related to tile size and not to the number of tiles. Larger tiles increase the amount of memory used by the node."]}, {"indent": 4, "type": "para", "extent": [6036, 6318], "text": ["This value is a scale on the ", {"text": ["Influence Radius"], "type": "ui"}, " parameter on the ", {"text": ["Particles"], "type": "ui"}, " tab.\n    So, if you keep the ", {"text": ["Influence Radius"], "type": "ui"}, " the same, doubling this value increases the memory usage 8 times. Similarly, halving the voxel size would also increase memory usage 8 times."]}], "indent": 0, "text": ["Tile Size"], "role": "item", "extent": [5521, 5532], "type": "parameters_item"}, {"body": [{"indent": 8, "type": "para", "extent": [6331, 6882], "text": ["The displacement of the origin of the tile array from the grid origin. Changing this parameter shifts the entire array of tiles by the specified amount (rounded to the nearest multiples of voxel size). Modifying this parameter can reduce the number of tiles which overlap the main body of the fluid and this can noticeably improve the performance of the node. For example, if the fluid simulation contains a shallow pool of water, it is a good idea to have this main pool (ignoring the splashes) covered by as few rows of tiles as possible. "]}], "indent": 0, "text": ["Tile Offset"], "role": "item", "extent": [6318, 6331], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}, {"body": [{"body": [{"indent": 8, "type": "para", "extent": [6896, 7118], "text": ["It is very important to have the ", {"text": ["Tile Offset"], "type": "ui"}, " set to a fixed value for the entire range of frames for which the fluid is being surfaced as this ensures frame-to-frame coherence between the generated surfaces. "]}], "indent": 0, "text": ["        "], "role": "item", "extent": [6882, 6896], "type": "note"}], "container": true, "role": "item_group", "type": "note_group"}, {"body": [{"body": [{"indent": 4, "type": "para", "extent": [7138, 7505], "text": ["The amount of extra overlap between adjacent tiles.\n    The larger the padding, the lower the risk of inconsistencies between tiles, but at the same time, the more \n    the amount of work the node has to do per tile. Increasing this value can greatly increase the cooking time \n    of the node. Increasing this beyond ", {"text": ["3"], "type": "code"}, " generally has little to no benefit."]}, {"body": [{"indent": 8, "type": "para", "extent": [7600, 7676], "text": ["The padding amount should be less than half the size of the tile. "]}], "indent": 4, "type": "para", "extent": [7505, 7600], "text": ["This value is a scale on the ", {"text": ["Influence radius"], "type": "ui"}, " parameter on the ", {"text": ["Particles"], "type": "ui"}, " tab."]}], "indent": 0, "text": ["Additional Padding"], "role": "item", "extent": [7118, 7138], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [7727, 7841], "text": ["If turned on, the maximum ", {"text": ["percentage of the computer\u2019s total memory"], "type": "em"}, " to use for the node\u2019s work buffer."]}, {"indent": 4, "type": "para", "extent": [7841, 7931], "text": ["This does not affect the amount of memory used by the field created by the node."]}, {"indent": 4, "type": "para", "extent": [7931, 8205], "text": ["Large ", {"text": ["Tile size"], "type": "ui"}, " and ", {"text": ["Additional padding"], "type": "ui"}, " values may make it impossible to fit within this restriction.\n    In that case, the node will stop and display an error.\n    If the amount of memory is too small to use all available CPUs, the node will display a warning."]}], "indent": 0, "text": ["Limit Physical Memory %"], "role": "item", "attrs": {"id": "memoryusage"}, "extent": [7676, 7701], "type": "parameters_item"}, {"body": [{"indent": 4, "type": "para", "extent": [8216, 8338], "text": ["The choice of visualization of ", {"text": ["Tiles"], "type": "ui"}, " or ", {"text": ["Padded Tiles"], "type": "ui"}, " (or both) used for the breakdown of the surfacing job. "]}], "indent": 0, "text": ["Visualize"], "role": "item", "extent": [8205, 8216], "type": "parameters_item"}], "container": true, "role": "item_group", "type": "parameters_item_group"}, {"body": [{"body": [{"indent": 4, "type": "para", "extent": [8344, 8418], "text": ["You can press ", {"keys": ["MMB"], "text": null, "type": "keys"}, " on the node to see the number of CPUs it used."]}], "indent": 0, "role": "item", "type": "note", "extent": [8338, 8344]}], "container": true, "role": "item_group", "type": "note_group"}], "indent": 0, "level": 2, "text": ["Tiles"], "extent": [5392, 5405], "container": true, "type": "h", "id": null}], "indent": 0, "level": 1, "text": "Parameters", "role": "section", "extent": [855, 867], "container": true, "type": "parameters_section", "id": "parameters"}, {"body": [{"body": [{"body": [{"indent": 4, "type": "para", "extent": [8449, 8650], "text": ["The particle geometry to generate a surface around. In general you will connect the particle field from a particle fluid simulation, however any set of points may be used as an input to this SOP."]}], "indent": 0, "type": "dt", "extent": [8426, 8449], "text": ["Particle Fluid Field"]}], "container": true, "type": "dt_group"}], "indent": 0, "level": 1, "text": "Inputs", "role": "section", "extent": [8418, 8426], "container": true, "type": "inputs_section", "id": "inputs"}, {"body": [{"body": [{"indent": 0, "blevel": 2, "type": "bullet", "extent": [8659, 8693], "text": [{"text": "", "fullpath": "/nodes/dop/particlefluidobject", "scheme": "Node", "type": "link", "value": "/nodes/dop/particlefluidobject"}]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [8693, 8726], "text": [{"text": "", "fullpath": "/nodes/dop/particlefluidsolver", "scheme": "Node", "type": "link", "value": "/nodes/dop/particlefluidsolver"}]}, {"indent": 0, "blevel": 2, "type": "bullet", "extent": [8726, 8760], "text": [{"text": "", "fullpath": "/nodes/sop/particlefluidsurface", "scheme": "Node", "type": "link", "value": "/nodes/sop/particlefluidsurface"}]}], "container": true, "type": "bullet_group"}], "indent": 0, "level": 1, "text": "Related", "role": "section", "extent": [8650, 8659], "container": true, "type": "related_section", "id": "related"}], "summary": ["Generates a signed distance field (SDF) VDB volume representing the surface of a set of particles from a particle fluid simulation."], "type": "root", "attrs": {"version": null, "tags": "fluid, surface", "namespace": null, "internal": "vdbfromparticlefluid", "context": "sop", "type": "node", "icon": "SOP/vdbparticlefluid"}, "title": ["VDB from Particle Fluid"]}